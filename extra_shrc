#makes some shortcuts available for vim instead for shell
stty -ixon

# VI input mode
set -o vi

# set for i3-sensible-terminal
export TERMINAL="st"

export EDITOR=/usr/bin/vim

export PYTHONSTARTUP=~/.pythonrc

# make fzf search hidden directories
# https://github.com/junegunn/fzf/issues/337#issuecomment-136389913
export FZF_DEFAULT_COMMAND='ag --hidden --ignore .git -g ""'
export FZF_CTRL_T_COMMAND="$FZF_DEFAULT_COMMAND"
export FZF_COMPLETION_TRIGGER='+'
export FZF_CTRL_T_OPTS='--preview "coderay {} | head -200"'
export FZF_COMPLETION_OPTS="--preview '[[ ! -f {} ]] && \
    echo {} is not a regular file || \
    coderay {} | head -200'"

#nvbn/thefuck
command -v thefuck >/dev/null 2>&1 && eval "$(thefuck --alias)"

command -v hub >/dev/null 2>&1 && eval "$(hub alias -s)"

# http://www.simononsoftware.com/virtualenv-tutorial-part-2/
if [ -e /usr/local/bin/virtualenvwrapper.sh ]; then
    export WORKON_HOME=$HOME/.virtualenvs
    . /usr/local/bin/virtualenvwrapper.sh
elif [ -e /usr/share/virtualenvwrapper/virtualenvwrapper.sh ]; then
    export WORKON_HOME=$HOME/.virtualenvs
    . /usr/share/virtualenvwrapper/virtualenvwrapper.sh
fi

#http://askubuntu.com/questions/362280/enter-ssh-passphrase-once
SSH_ENV=$HOME/.ssh/env
if [ ! -e "$SSH_ENV" ]; then
    mkdir -p $HOME/.ssh
    touch "$SSH_ENV"
fi
function start_agent {
    # spawn ssh-agent
    /usr/bin/ssh-agent | sed 's/^echo/#echo/' > "${SSH_ENV}"
    chmod 600 "${SSH_ENV}"
    . "${SSH_ENV}" > /dev/null
    /usr/bin/ssh-add
}

if [ -f "${SSH_ENV}" ]; then
     . "${SSH_ENV}" > /dev/null
     ps -ef | grep ${SSH_AGENT_PID} | grep ssh-agent$ > /dev/null || {
        start_agent;
    }
else
    start_agent;
fi
